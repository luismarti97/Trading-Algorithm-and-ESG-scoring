# Trading-Algorithm-and-ESG-scoring
In this project, I will explain step by step how to create a reliable ESG scoring based on external information, using NLP and LSTM, with the objective of using the data in a trading algorithm.
**Abstract:** This Master's Thesis presents the design, implementation, and evaluation of an innovative system for the investment and rating of companies based on ESG (Environmental, Social, and Governance) criteria. The system utilizes Natural Language Processing (NLP) techniques to analyze large volumes of financial news, identify relevant events, and assess the associated sentiment. This information serves as input for Long Short-Term Memory (LSTM) recurrent neural network models, which predict daily dynamic ESG scores for each company. Finally, these scores are integrated into a signal-based investment algorithm, aiming to validate the hypothesis that the use of unstructured ESG information enhances investment decision-making. The analysis focuses on 30 companies from the S&P 500 index, distributed across six key sectors.
**Keywords:** ESG, Quantitative Investment, Natural Language Processing (NLP), Sentiment Analysis, LSTM Networks, Investment Signals, Financial Markets.
## Table of Contents
1. [INTRODUCTION](#1-introduction)
2. [THEORETICAL FRAMEWORK](#2-theoretical-framework)
    * [a. The Integration of ESG Criteria in Financial Markets](#a-the-integration-of-esg-criteria-in-financial-markets)
    * [b. Limitations of Traditional ESG Ratings](#b-limitations-of-traditional-esg-ratings)
    * [c. The Treatment of Unstructured Data as an ESG Alternative](#c-the-treatment-of-unstructured-data-as-an-esg-alternative)
    * [d. Natural Language Processing for ESG Rating](#d-natural-language-processing-nlp-for-esg-rating)
    * [e. Prediction of ESG Scores with LSTM Models](#e-prediction-of-esg-scores-with-lstm-models)
    * [f. Investment Strategies Based on ESG Signals](#f-investment-strategies-based-on-esg-signals)
3. [DATA EXTRACTION](#3-data-extraction)
    * [a. Company and Sector Selection](#a-company-and-sector-selection)
    * [b. Sources Used and Justification](#b-sources-used-and-justification)
    * [c. Validation and Homogenization Process](#c-validation-and-homogenization-process)
4. [FIRST NLP MODEL](#4-first-nlp-model)
    * [a. News Tagging](#a-news-tagging)
        * [i. Description of the Automated Tagging Process](#i-description-of-the-automated-tagging-process)
    * [b. Model Architecture and Training](#b-model-architecture-and-training)
        * [i. Training Dataset](#i-training-dataset)
        * [ii. Preprocessing and Tokenization](#ii-preprocessing-and-tokenization)
        * [iii. Model Architecture](#iii-model-architecture)
        * [iv. Training Procedure](#iv-training-procedure)
        * [v. Results and Evaluation](#v-results-and-evaluation)
        * [vi. Conclusion](#vi-conclusion)
    * [c. Inference on the Complete Dataset](#c-inference-on-the-complete-dataset)
        * [i. Corpus Preparation for Inference](#i-corpus-preparation-for-inference)
        * [ii. Procedure](#ii-procedure)
        * [iii. Validation and Quality Control](#iii-validation-and-quality-control)
5. [SECOND NLP MODEL](#5-second-nlp-model)
    * [a. Model Architecture and Training](#a-model-architecture-and-training-1)
        * [i. Training Dataset](#i-training-dataset-1)
        * [ii. Training Procedure](#ii-training-procedure-1)
        * [iii. Results and Evaluation](#iii-results-and-evaluation-1)
    * [b. Inference on the Complete Dataset](#b-inference-on-the-complete-dataset-1)
6. [THIRD NLP MODEL](#6-third-nlp-model)
    * [a. Model Architecture and Training](#a-model-architecture-and-training-2)
        * [i. Training and Application of a Proprietary Sentiment Analysis Model](#i-training-and-application-of-a-proprietary-sentiment-analysis-model)
        * [ii. Model Architecture](#ii-model-architecture-1)
        * [iii. Results](#iii-results-1)
7. [DATA PREPARATION](#7-data-preparation)
8. [MEDIA REPUTATION](#8-media-reputation)
    * [a. Theoretical Basis](#a-theoretical-basis)
    * [b. Development](#b-development)
9. [DATA EXPLORATION](#9-data-exploration)
    * [a. Data Preparation](#a-data-preparation-1)
    * [b. Distribution of News by Company and ESG Category](#b-distribution-of-news-by-company-and-esg-category)
    * [c. Clustering Analysis 2](#c-clustering-analysis-2)
10. [LSTM](#10-lstm)
    * [a. Embedding Creation](#a-embedding-creation)
        * [i. Data Preparation](#i-data-preparation-2)
        * [ii. Embedding Generation](#ii-embedding-generation-1)
        * [iii. Aggregation and Dimensional Reduction](#iii-aggregation-and-dimensional-reduction)
        * [iv. Embedding Enrichment](#iv-embedding-enrichment)
    * [b. Window Generation](#b-window-generation)
        * [i. Theoretical Basis](#i-theoretical-basis-1)
        * [ii. Window Generation with Padding](#ii-window-generation-with-padding)
        * [iii. Statistics and Validations](#iii-statistics-and-validations)
        * [iv. Results Export](#iv-results-export)
    * [c. Window Association](#c-window-association)
        * [i. Theoretical Basis](#i-theoretical-basis-2)
        * [ii. Data Preparation](#ii-data-preparation-3)
        * [iii. Tolerant Association Algorithm](#iii-tolerant-association-algorithm)
        * [iv. Validation and Export](#iv-validation-and-export-1)
    * [d. Training](#d-training)
        * [i. Data Loading and Preparation](#i-data-loading-and-preparation)
        * [ii. LSTM Architecture Design](#ii-lstm-architecture-design)
        * [iii. Training Configuration](#iii-training-configuration)
        * [iv. Evaluation](#iv-evaluation-1)
11. [CREATION OF A COMPLETE DATASET](#11-creation-of-a-complete-dataset)
    * [a. Theoretical Basis](#a-theoretical-basis-2)
    * [b. Data Loading](#b-data-loading)
    * [c. Generation of New 7-Day Windows](#c-generation-of-new-7-day-windows)
    * [d. Training of a New LSTM Model](#d-training-of-a-new-lstm-model)
    * [e. Filtering of Companies and Categories](#e-filtering-of-companies-and-categories)
    * [f. Interpolation of Official Scores and Predictions](#f-interpolation-of-official-scores-and-predictions)
    * [g. Final Generated Dataset](#g-final-generated-dataset)
12. [DEVELOPMENT OF AN INVESTMENT ALGORITHM](#12-development-of-an-investment-algorithm)
    * [a. Data Loading and Preparation](#a-data-loading-and-preparation-1)
    * [b. Modular Design of the Trading System](#b-modular-design-of-the-trading-system)
    * [c. Investment Strategy by ESG Categories](#c-investment-strategy-by-esg-categories)
    * [d. Operational Backtest](#d-operational-backtest)
    * [e. Results Analysis](#e-results-analysis)
    * [f. Comparison of the ESG Strategy Against the Benchmark](#f-comparison-of-the-esg-strategy-against-the-benchmark)
    * [g. Interpretation and Conclusions](#g-interpretation-and-conclusions)
    * [h. Lines of Improvement and Exposure Optimization](#h-lines-of-improvement-and-exposure-optimization)
    * [i. Summary](#i-summary)
13. [STREAMLIT AND GOOGLE CLOUD](#13-streamlit-and-google-cloud)
    * [a. ESG Dashboard](#a-esg-dashboard)
        * [i. Objectives](#i-objectives-2)
        * [ii. General Project Architecture](#ii-general-project-architecture)
        * [iii. Application Development](#iii-application-development)
        * [iv. Justification of the Cloud Architecture](#iv-justification-of-the-cloud-architecture)
        * [v. Deployment](#v-deployment)
    * [b. ESG Strategy Simulator and Signal Generator](#b-esg-strategy-simulator-and-signal-generator)
        * [i. Objective 3](#i-objective-3-1)
        * [ii. Development](#ii-development-1)
    * [c. Training on Vertex AI](#c-training-on-vertex-ai)
        * [i. Scalability](#i-scalability-1)
        * [ii. Deployment](#ii-deployment-2)
        * [iii. Conclusions](#iii-conclusions-2)
14. [DISCARDED APPROACHES](#14-discarded-approaches)
    * [a. Use of Company Sustainability Reports](#a-use-of-company-sustainability-reports)
    * [b. Constant Information to Complement the LSTM Network Beyond the Cluster](#b-constant-information-to-complement-the-lstm-network-beyond-the-cluster)
15. [BIBLIOGRAPHY](#15-bibliography)
